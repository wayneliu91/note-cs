# 整体组成

- 多个生产者。
- 多个broker。
- 多个消费者。
- 一个ZooKeeper集群。

# 主题和分区

一个主题对多个分区，反过来，一个分区只能对应一个主题。分区类似于数据库中的水平分库分表，每个分区的消息是不同的，因此只能保证分区有序，不保证主题有序。每个分区为了保证数据不丢失，又使用了多副本机制，多副本之间采用主从模式，主副本负责读写，从副本只负责同步，当主挂了，重新选主（数据库的主从HA一样，主库负责读写，从库可以只备份，如果主宕，选一个从成为主）。

水平分区，每个分区多副本，副本之间主从，主宕选主，这些思想和数据库完全一样，缺点也一样，主从有延迟，如果主副本宕机，会丢失一部分数据。

